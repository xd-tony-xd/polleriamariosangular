<h2 mat-dialog-title class="text-2xl font-bold text-gray-800 border-b pb-2 mb-3 flex items-center gap-2">
  <mat-icon color="warn">{{ isEditMode ? 'edit' : 'library_add' }}</mat-icon>
  {{ isEditMode ? 'Editar Extra' : 'Nuevo Extra' }}
</h2>

<form [formGroup]="extraForm" (ngSubmit)="onSubmit()">

  <mat-dialog-content class="flex flex-col gap-4">

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Nombre</mat-label>
      <input matInput formControlName="nombre">
      <mat-error *ngIf="extraForm.get('nombre')?.invalid">Requerido.</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Descripción</mat-label>
      <textarea matInput rows="3" formControlName="descripcion"></textarea>
      <mat-error *ngIf="extraForm.get('descripcion')?.invalid">Requerido.</mat-error>
    </mat-form-field>

    <div class="flex items-center gap-3">
      <mat-form-field appearance="outline" class="w-2/3">
        <mat-label>Precio</mat-label>
        <input matInput type="number" formControlName="precio">
      </mat-form-field>

      <mat-slide-toggle formControlName="disponible">
        {{ extraForm.get('disponible')?.value ? 'EN VENTA' : 'AGOTADO' }}
      </mat-slide-toggle>
    </div>

        <div class="p-3 border rounded-lg bg-gray-50">
      <label class="font-semibold mb-2 flex items-center gap-1">
        <mat-icon>photo_camera</mat-icon> Fuente de Imagen
      </label>
      
      <div class="flex gap-4 mb-3 text-sm">
          <mat-button-toggle-group [value]="showFilePicker ? 'file' : 'url'" name="imageInputToggle">
              <mat-button-toggle value="file" (click)="toggleImageInput(true)">
                  <mat-icon class="mr-1">upload</mat-icon> Subir Archivo
              </mat-button-toggle>
              <mat-button-toggle value="url" (click)="toggleImageInput(false)">
                  <mat-icon class="mr-1">link</mat-icon> Usar URL Externa
              </mat-button-toggle>
          </mat-button-toggle-group>
      </div>

      <div class="flex flex-col gap-3">
          
          <div *ngIf="showFilePicker">
              <div class="flex items-center gap-4">
                  <img *ngIf="imagePreview"
                    [src]="imagePreview"
                    class="w-16 h-16 object-cover rounded border shadow">
                  
                  <input type="file" accept="image/*" (change)="onFileSelected($event)"
                    class="text-sm cursor-pointer">
              </div>
          </div>

          <div *ngIf="!showFilePicker">
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>URL de Imagen Externa</mat-label>
                <input matInput formControlName="urlImagen" placeholder="https://ejemplo.com/imagen.jpg"
                       (input)="onUrlChange()">
                <mat-icon matSuffix>link</mat-icon>
              </mat-form-field>
              
              <div *ngIf="extraForm.get('urlImagen')?.value" class="mt-2">
                <label class="text-xs font-semibold text-gray-600">Previsualización:</label>
                 <img [src]="extraForm.get('urlImagen')?.value" 
                      class="w-16 h-16 object-cover rounded border shadow mt-1">
              </div>
          </div>
          
          <p *ngIf="!isEditMode && !selectedFile && !extraForm.get('urlImagen')?.value" class="text-xs text-red-500 mt-1">
            * Requerida para crear (archivo o URL).
          </p>

      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end" class="mt-2 border-t pt-3">
    <button mat-button (click)="onCancel()">Cancelar</button>

    <button mat-raised-button color="warn" [disabled]="extraForm.invalid || isSubmitting">
      <mat-icon>{{ isEditMode ? 'save' : 'add' }}</mat-icon>
      {{ isEditMode ? 'Guardar' : 'Crear' }}
    </button>
  </mat-dialog-actions>
</form>